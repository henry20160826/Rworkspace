{
    "collab_server" : "",
    "contents" : "#引入一个画图库\nlibrary(plotly)\n\n#读取数据\ndata<-read.table(\"E:\\\\graduated life\\\\pattern recognition\\\\data.txt\",header = T)\n# data\n\n#画出男生身高的直方图\nboy<-data[data[,2]==1,]\nboyheight<-boy[,4]\nboyht<-table(boyheight)\nbarplot(boyht,main=\"男生身高的直方图\")\n#画出女生身高的直方图\ngirl<-data[data[,2]==0,]\ngirlheight<-girl[,4]\ngirlht<-table(girlheight)\nbarplot(girlht,main=\"女生身高的直方图\")\n\n#取出男生女生体重\nboyweight<-boy[,5]\ngirlweight<-girl[,5]\n#统计男生女生人数\nboyNum<-dim(boy)[1]\ngirlNum<-dim(girl)[1]\n#计算男生女生身高概率\ngirlHP<-girlheight/girlNum\nboyHP<-boyheight/boyNum\n#画出男生体重的直方图\nboywt<-table(boyweight)\nbarplot(boywt,main=\"男生体重的直方图\")\n#画出女生体重的直方图\ngirlwt<-table(girlweight)\nbarplot(girlwt,main=\"女生体重的直方图\")\n\n\n#正态分布的最大似然估计参数为期望和方差\n#计算身高期望\nboyEh<-mean(boyheight);\ngirlEh<-mean(girlheight);\n#计算体重期望\nboyEw<-mean(boyweight);\ngirlEw<-mean(girlweight);\n#计算身高方差\n#var()函数采用无偏估计，除以N-1，所以此处未使用var函数\nboyDh<-mean((boyheight-boyEh)^2)\ngirlDh<-mean((girlheight-girlEh)^2)\n#计算体重方差\nboyDw<-mean((boyweight-boyEw)^2)\ngirlDw<-mean((girlweight-girlEw)^2)\n\n#身高，体重联合方式计算期望方差\ngetMLEu<-function()\n{\n  \n}\ngetMLEo2<-function()\n{\n  \n}\nboyHW<-boy[,4:5]\nuboy<-colMeans(boyHW)\noboy<-(t(boyHW)-uboy)%*%t((t(boyHW)-uboy))/boyNum\n\ngirlHW<-girl[,4:5]\nugirl<-colMeans(girlHW)\nogirl<-(t(girlHW)-ugirl)%*%t((t(girlHW)-ugirl))/girlNum\n\n#正态分布的贝叶斯估计\ngetBayesE<-function(N,e,Dx,u,o2)\n{\n  return((N*e*o2+Dx*u)/(N*o2+Dx))\n}\ngetBayesD<- function(o2,Dx,N) \n{\n  return(o2*Dx/(N*o2+Dx))\n}\n#设男生身高期望服从\nu<-seq(160,180,length.out = 3)\no<-seq(0,6,length.out = 7)\nfor(i in 1:length(u))\n{\n  for(j in 1:length(o))\n  {\n    print(getBayesE(boyNum,boyEh,boyDh,u[i],o[j]^2))\n    print(getBayesD(o[j]^2,boyDh,boyNum))\n  }\n}\nu<-200\no2<-1\ngetBayesE(boyNum,boyEh,boyDh,u,o2)\ngetBayesD(o2,boyDh,boyNum)\n\n#设女生身高期望服从N(160,10)\nu<-160\no2<-10\ngirlBayesEh=getBayesE(girlNum,girlEh,girlDh,u,o2)\ngirlBayesDh=getBayesD(o2,girlDh,girlNum);\n\n#设男生体重期望服从N(65,100)\nu<-65\no2<-100\nboyBayesEw=getBayesE(boyNum,boyEw,boyDw,u,o2)\nboyBayesDW=getBayesD(o2,boyDw,boyNum)\n#设女生体重期望服从N(50,15)\nu<-50\no2<-15\ngirlBayesEw=getBayesE(girlNum,girlEw,girlDw,u,o2)\ngirlBayesDw=getBayesD(o2,girlDw,girlNum)\n\n#原始数据散点图\n#纵坐标为体重\n#横坐标为身高\n#点的大小为体重与身高的乘积\n#男生女生的数据有混杂在一起的部分，紧靠身高和体重两个数据，有部分数据很难区分男女生\nplot_ly(data, x = data[,4], y = data[,5],mode = \"markers\",\n        color =data[,2],size=data[,4]*data[,5])\n\n\n#最小错误率贝叶斯决策\nnum=boyNum+girlNum\npw1=boyNum/num\npw2=girlNum/num\n#画出男生的身高体重分布图，x轴身高，y轴体重，z轴概率\nx<-seq(150,190,length.out = 100)\ny<-seq(40,100,length.out = 100)\ndet_oboy<-det(oboy)\ndet_ogirl<-det(ogirl)\nsolve_oboy=solve(oboy)\nsolve_ogirl=solve(ogirl)\nf<-function(x,y)\n{\n  a<-sqrt(det_oboy)*2*pi\n  solve_m<-solve(oboy)\n  ea<-solve_m[1,1]*(x-boyEh)^2+2*solve_m[1,2]*(x-boyEh)*(y-boyEw)+solve_m[2,2]*(y-boyEw)^2\n  return(exp((-1/2)*ea)/a)\n}\nzboy<-outer(x,y,f)\npersp(x,y,zboy,phi=90)\nf1<-function(x,y)\n{\n  a<-sqrt(det_ogirl)*2*pi\n  solve_m<-solve(ogirl)\n  ea<-solve_m[1,1]*(x-girlEh)^2+2*solve_m[1,2]*(x-girlEh)*(y-girlEw)+solve_m[2,2]*(y-girlEw)^2\n  return(exp((-1/2)*ea)/a)\n}\nzgirl<-outer(x,y,f1)\npersp(x,y,zgirl,phi=90)\n\n#男生女生散点图\n# s_zboy<-f(x,y)\n# plot_ly(data, x = x, y = y,mode = \"markers\",\n#         color =s_zboy,size=x*y)\n# s_zgirl<-f1(x,y)\n# plot_ly(data, x = x, y = y,mode = \"markers\",\n#         color =s_zgirl,size=x*y)\n\n#男生，女生三维概率分布图\nlibrary(plotly)\np<-plot_ly(x=x,y=y,z = zboy,type = \"surface\") %>%\n  add_trace(x=x,y=y,z = zgirl,type = \"surface\")\np\nl<-matrix(0,100,100)\nfor(i in 1:100)\n{\n  for(j in 1:100)\n  {\n    if(zboy[i,j]>zgirl[i,j])\n    {\n      l[i,j]<-1\n    }\n    else\n    {\n      l[i,j]<-0\n    }\n  }\n}\nplot_ly(x=x,y=y,z=l,type = \"surface\")\n\n#z\n#160,45\n#178,70\npboy=boyNum/num\npgirl=girlNum/num\n\nBWboy=-1/2*solve_oboy\nwboy=solve_oboy*uboy\nwboy0=-1/2*t(uboy)%*%solve_oboy%*%uboy-1/2*log(det_oboy)+log(pboy)\n\nBWgirl=-1/2*solve_ogirl\nwgirl=solve_ogirl*ugirl\nwgirl0=-1/2*t(ugirl)%*%solve_ogirl%*%ugirl-1/2*log(det_ogirl)+log(pgirl)\n\nBW=BWboy-BWgirl\nw=wboy-wgirl\nw0=wboy0-wgirl0\n\ngboy<-function(x)\n{\n  -1/2*t(x-uboy)%*%solve_oboy%*%(x-uboy)-1/2*log(det_oboy)+log(pboy)\n}\n\nggirl<-function(x)\n{\n  -1/2*t(x-ugirl)%*%solve_ogirl%*%(x-ugirl)-1/2*log(det_ogirl)+log(pgirl)\n}\n\nis_boy<-function(x)\n{\n  if(gboy(x)>ggirl(x))\n  {\n    print(\"判断为男生\")\n    return(1)\n  }\n  else\n  {\n    print(\"判断为女生\")\n    return(0)\n  }\n}\n\none<-c(178,70)\ngboy(one)\nggirl(one)\nis_boy(one)\n\none<-c(160,45)\ngboy(one)\nggirl(one)\nis_boy(one)\n\n#尝试用解方程的方法画出决策面\n# a=BW[1,1]\n# b=2*BW[1,2]*y+w[1]\n# c=BW[2,2]*y^2+w[2]*y+w0\n# \n# x1=(-b+sqrt(b^2-4*a*c))/2*a\n# x2=(-b-sqrt(b^2-4*a*c))/2*a\n# \n# plot(y,x1,type=\"l\")\n# plot(y,x2,type=\"l\")\n\n\n\n",
    "created" : 1473568644117.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3766477087",
    "id" : "5AE69CB9",
    "lastKnownWriteTime" : 1474174093,
    "last_content_update" : 1474174093964,
    "path" : "G:/Rworkspace/PRhomework1/main.R",
    "project_path" : "main.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}